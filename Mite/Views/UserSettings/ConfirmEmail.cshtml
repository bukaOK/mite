@model Mite.Models.EmailSettingsModel

<h3 class="ui header">E-mail</h3>
@if (Model.Confirmed)
{
    <div class="ui green message">
        <p>Ваш e-mail успешно подтвержден!</p>
    </div>
}
else
{
    <div class="ui red message">
        <p>Ваш e-mail не подтвержден.</p>
    </div>
    <div class="ui yellow message" hidden id="emailSendedMsg">
        <p>На ваш почтовый ящик отправлено сообщение с подтверждением.</p>
    </div>
    <div class="ui red message" hidden id="emailSendingFailedMsg">
        <p>Не удалось отправить сообщение для подтверждения почты, попробуйте позже, если не вышло - обратитесь к администратору.</p>
    </div>
    using (Html.BeginForm("SendEmailConfirmation", "UserSettings", FormMethod.Post, new { id = "emailConfirmForm" }))
    {
        @Html.AntiForgeryToken()
        <button type="button" class="ui primary button" id="confirmEmailBtn" onclick="sendEmailConfirmation(this)">Отправить подтверждение</button>
    }
    <script>
        function sendEmailConfirmation(ev) {
            $(ev).addClass('loading disabled');
            $.ajax({
                url: '@Url.Action("SendEmailConfirmation", "UserSettings")',
                type: 'post',
                data: $('#emailConfirmForm').serialize(),
                success: function (resp) {
                    $('#emailSendedMsg').show();
                },
                error: function () {
                    $('#emailSendingFailedMsg').show();
                },
                complete: function () {
                    $(ev).removeClass('loading disabled');
                }
            })
        }
    </script>
}